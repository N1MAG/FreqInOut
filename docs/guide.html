<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FreqInOut User Guide</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 0 18px 40px 18px; background: #fafafa; color: #222; }
    h1, h2, h3 { margin-top: 1.2em; }
    h1 { border-bottom: 2px solid #ddd; padding-bottom: 0.3em; }
    h2 { border-bottom: 1px solid #eee; padding-bottom: 0.15em; }
    code { background: #f2f2f2; padding: 2px 4px; border-radius: 3px; }
    pre { background: #f2f2f2; padding: 10px; border-radius: 4px; overflow-x: auto; }
    ul { margin-top: 0.3em; }
    .section-list { padding-left: 18px; }
    .logo-wrap { text-align: center; padding-top: 18px; }
    .logo-wrap img { max-width: 180px; height: auto; }
    .callout { background: #eef5ff; border-left: 4px solid #5b8def; padding: 10px 12px; margin: 12px 0; }
    .warn { background: #fff7e6; border-left: 4px solid #e0a106; }
    table { border-collapse: collapse; width: 100%; margin: 10px 0; }
    th, td { border: 1px solid #ddd; padding: 6px 8px; text-align: left; }
  </style>
</head>
<body>
  <div class="logo-wrap">
    <img src="../assets/FreqInOut_logo.png" alt="FreqInOut logo" />
  </div>

  <h1 id="guide-home">FreqInOut User Guide</h1>
  <p><strong>Current version</strong>: 1.0.0</p>
  <p>This guide describes every tab, button, field, and function in FreqInOut. Times are stored in UTC; the "Showing: Local/UTC" toggle only changes what you see.</p>
  <p><strong>Responsibility notice</strong>: FreqInOut assists licensed amateur operators by coordinating complex radio software and schedules. It assumes you follow applicable band plans and regulations. Disabling safeguards (for example, scheduling) can let you tune outside legal allocations. You are solely responsible for compliant operation; the authors and contributors are not liable for misuse.</p>

  <h2 id="quick-start">Quick Start</h2>
  <ul class="section-list">
    <li><strong>1) Configure Settings and Save</strong>: Fill out operator info, frequency control, JS8Call paths (DIRECTED.TXT), message paths, operating groups, and radio software paths. Click <em>Save Settings</em> to emit the settings-saved signal so QSY lists and JS8 options refresh.</li>
    <li><strong>2) Import operators</strong>: In the <em>Operators</em> tab, import your operator list so stations can populate the <em>Map</em> tab and net controls can show names/state/region.</li>
    <li><strong>3) Load JS8 traffic</strong>: Back in <em>Settings</em>, click <em>Load JS8 Traffic</em> to ingest recent logs for map/link data and JS8 net features.</li>
    <li><strong>Optional sanity checks</strong>: Ensure <em>Use Scheduler</em> is enabled if you want automated QSY, verify your timezone buttons show the desired view, and set Logs level (Info/Debug/Disabled) before long runs.</li>
  </ul>

  <h2 id="prerequisites">1. Prerequisites</h2>
  <ul class="section-list">
    <li><strong>Install method</strong>: Packaged builds (.exe/.deb) include app dependencies; follow your OS installer prompts. Source installs use a Python venv and <code>pip install -r requirements.txt</code>.</li>
    <li><strong>Python</strong>: 3.9-3.12. Create a venv and run <code>pip install -r requirements.txt</code>.</li>
    <li><strong>Debian/Ubuntu</strong>: Use the stock python3 (no PPAs). Install tools: <code>sudo apt-get install python3 python3-venv python3-pip libxcb-cursor0 libxcb-xinerama0</code>, then create venv and install requirements.</li>
    <li><strong>Radio software</strong>: Install and configure FLRig (rig control) and/or JS8Call (JS8).</li>
    <li><strong>Paths</strong>: Know where JS8Call stores DIRECTED.TXT, ALL.TXT, inbox_v1/inbox.db3, and where FLMSG/FLAMP/VarAC folders live if you use Message Viewer.</li>
  </ul>

  <h2 id="settings">2. Settings Tab</h2>
  <h3 id="settings-operator">Operator Information</h3>
  <ul class="section-list">
    <li><strong>Callsign / Name / State / Grid6</strong>: Used everywhere (planner labels, map pins, net control defaults, short-code logic). A 6-character grid is roughly a 24-square-mile areaâ€”granular enough for mapping but generally privacy friendly.</li>
  </ul>

  <h3 id="settings-operation">Operation Settings</h3>
  <ul class="section-list">
    <li><strong>Frequency Control</strong>: Choose FLRig, JS8Call, or Manual. FLRig requires XMLRPC port. Manual means no rig commands are sent.</li>
    <li><strong>Use Scheduler</strong>: Master enable for schedule-driven rig changes. When off, QSY buttons are gray and scheduler output is suppressed.</li>
  </ul>

  <h3 id="settings-js8call">JS8Call Settings</h3>
  <ul class="section-list">
    <li><strong>TCP Port / Offset (Hz)</strong>: Must match JS8Call configuration.</li>
    <li><strong>DIRECTED.TXT path</strong>: Browse to JS8Call's DIRECTED.TXT. ALL.TXT and inbox are inferred from the same folder.</li>
    <li><strong>JS8Spotter forms</strong>: Path to the MCF form folder used to decode F!### spotter traffic.</li>
    <li><strong>Auto Query Msg ID / Auto Query Grids</strong>: Enables background queries when nets are not active, respecting lockouts and timers.</li>
    <li><strong>Load JS8 Traffic</strong>: Manual ingest of logs into the map and link index.</li>
  </ul>

  <h3 id="settings-op-groups">Operating Groups</h3>
  <ul class="section-list">
    <li><strong>Purpose</strong>: Configure the frequencies you rely on (MagNet, other groups, nets you join, local club). These rows drive Daily/Net schedules, QSY dropdowns, and auto-tune flags.</li>
    <li><strong>Columns</strong>: Group, Mode, Band, Freq (MHz), Auto-Tune.</li>
    <li><strong>Add Group</strong>: Dialog to enter Group, Mode, Band, Frequency, Auto-Tune flag.</li>
    <li><strong>Edit Selected</strong>: Edit the single checked row.</li>
    <li><strong>Delete Selected</strong>: Remove checked rows.</li>
    <li><strong>Selection checkbox</strong>: Narrow box to mark rows for edit/delete; does not alter scheduling.</li>
    <li>Operating Groups feed Daily/Net schedules and QSY dropdowns. Auto-Tune triggers rig tune on QSY if supported.</li>
  </ul>

  <h3 id="settings-msg-paths">Message Paths</h3>
  <ul class="section-list">
    <li><strong>VarAC / FLMSG / FLAMP folders</strong>: Browse and save for Message Viewer lookups.</li>
  </ul>

  <h3 id="settings-radio">Radio Software</h3>
  <ul class="section-list">
    <li><strong>Path</strong>, <strong>Autostart</strong>, <strong>Enabled</strong> for FLRig, FLDigi, FLMSG, FLAMP, and other supported tools.</li>
    <li><strong>Autostart caution</strong>: Runs once when FreqInOut launches. It is an advanced option - most users should start apps manually. Startup order and your system resources matter; avoid enabling if your rig control or FLDigi needs a specific launch sequence.</li>
  </ul>

  <h3 id="settings-actions">Save Settings</h3>
  <ul class="section-list">
    <li><strong>Save Settings</strong>: Writes all settings and emits a "settings saved" signal. JS8 auto-query logic and QSY dropdowns refresh immediately.</li>
  </ul>

  <h2 id="scheduler">3. Scheduler and Planning</h2>
  <h3 id="scheduler-daily">Daily Schedule Tab</h3>
  <ul class="section-list">
    <li><strong>Columns</strong>: Day, Group Name, Mode, Band, VFO, Freq (MHz), Start, End, Auto-Tune.</li>
    <li><strong>Buttons</strong> (top row): Add Row, Delete Selected, Save HF Schedule (persist), Export HF Schedule (JSON file).</li>
    <li><strong>QSY row</strong>: Right side under the time bar shows Select Frequency dropdown (unique Operating Group freqs, auto-tune wins ties) and QSY button (manual change plus 30 minute pause).</li>
    <li><strong>Time toggle</strong>: "Showing: Local/UTC" flips the view only; data is stored in UTC. Default view is Local.</li>
    <li><strong>Day values</strong>: "ALL" applies every day. Overnight spans (start > end) extend into the next day.</li>
    <li><strong>Auto-Tune column</strong>: Marks whether to run rig tune when this row is applied.</li>
  </ul>

  <h3 id="scheduler-net">Net Schedule Tab</h3>
  <ul class="section-list">
    <li><strong>Columns</strong>: Day (Local/UTC view), Recurrence, Group, Mode, Band, VFO, Freq (MHz), Start, End, Early (min), Net Name.</li>
    <li><strong>Buttons</strong>: Add Row, Delete Selected, Save Net Schedule, Export Net Schedule (JSON file).</li>
    <li><strong>QSY controls</strong>: Same Select Frequency dropdown and QSY button as Daily (right side).</li>
    <li><strong>Early (min)</strong>: Shifts the active start earlier for rig changes only; display ignores early check-in.</li>
  </ul>

  <h3 id="scheduler-engine">Scheduler Engine</h3>
  <ul class="section-list">
    <li><strong>Sources</strong>: Net schedule takes priority when active; otherwise Daily schedule is used.</li>
    <li><strong>Application</strong>: Sends band/mode/VFO/frequency via the selected controller (FLRig or JS8Call). Manual mode never sends.</li>
    <li><strong>Safety</strong>: Skips changes while FLRig PTT is active, or JS8Call/VarAC is busy.</li>
    <li><strong>Suspend/QSY timer</strong>: Any QSY starts a 30 minute pause that suppresses schedule-driven changes. Shared across Daily, FLDigi NCS, and JS8 NCS.</li>
    <li><strong>Use Scheduler</strong>: When off, no schedule commands are emitted; QSY buttons remain disabled.</li>
  </ul>

  <h3 id="planner">Frequency Planner Tab</h3>
  <ul class="section-list">
    <li><strong>Grid</strong>: 24 hour columns for Local and UTC; rows Sun-Sat. Default view is Local. Column header shows short timezone abbreviation (for example MST).</li>
    <li><strong>Display rules</strong>: Shows band per hour; transitions honor partial hours and overnight spans. If two rows meet at the top of an hour, the band that owns the full hour is shown. Nets display only during their scheduled time, not the hour after.</li>
    <li><strong>Net highlight</strong>: Yellow highlight for nets in the next 24 hours and the currently active net. Past nets are not highlighted.</li>
    <li><strong>QSY controls</strong>: Dropdown and QSY button under the time bar; manual QSY also starts the 30 minute pause.</li>
  </ul>

  <h3 id="qsy-suspend">QSY / Suspend (shared behavior)</h3>
  <ul class="section-list">
    <li><strong>Select Frequency</strong>: Unique list from Operating Groups. If the same frequency appears twice and only one has Auto-Tune, Auto-Tune is used.</li>
    <li><strong>QSY button</strong>: Changes to the selected frequency immediately, triggers Auto-Tune if marked, and starts the 30 minute pause. Disabled if the scheduler is off or the selected frequency matches the current scheduler frequency.</li>
    <li><strong>Pause state</strong>: Shared timer and countdown text across Daily Schedule, FLDigi NCS, and JS8 NCS.</li>
  </ul>

  <h2 id="net-control">4. Net Control Tabs</h2>

  <h3 id="fldigi-ncs">FLDigi NCS Tab</h3>
  <ul class="section-list">
    <li><strong>Header</strong>: UTC/Local clocks and "Next Scheduled Net" based on Net Schedule.</li>
    <li><strong>Role</strong>: NCS or ANCS selector.</li>
    <li><strong>Net Name</strong>: Free text with auto-complete from Net Schedule.</li>
    <li><strong>Check-in Files</strong>: "Net Check-in File" and "New/Late Check-in File" paths with Browse buttons. Hints: "Full path to file (update macro if needed)".</li>
    <li><strong>Main Check-in Log / New / Late Check-ins</strong>: Text panes. "Copy" buttons to copy pane text. Lines are normalized to "CALLSIGN / Name / State" spacing when added or merged.</li>
    <li><strong>Operator Lookup/Add</strong>: Search or add operator; "Add to Main" and "Add to Late" insert formatted lines.</li>
    <li><strong>Buttons</strong>: Start Net (green, then gray), Save Check-ins (imports to history), Merge Check-ins (moves Late to Main without confirmation), End Net (confirms if empty), Ad Hoc Net, QSY.</li>
    <li><strong>Start behavior</strong>: Clears panes, pre-fills own callsign/name/state line, begins polling. Save turns green to prompt commit.</li>
    <li><strong>End behavior</strong>: Imports main check-ins to operator history; confirmation if no check-ins exist.</li>
    <li><strong>QSY</strong>: Same shared pause timer and dropdown; right-justified on the header row.</li>
  </ul>

  <h3 id="js8-ncs">JS8 NCS Tab</h3>
  <ul class="section-list">
    <li><strong>Header fields</strong>: UTC/Local clocks; Role (NCS/ANCS); Net Name; Refresh (seconds) sets log poll interval.</li>
    <li><strong>Group field and Set Group</strong>: Free form group; if missing "@", it is prepended. Used for group transmissions.</li>
    <li><strong>Spotter form and Set Spotter</strong>: Dropdown of MCF forms (F!###). Stores "F!###" only; button disabled if none selected.</li>
    <li><strong>Buttons row</strong>: Start Net (green then dark gray), ACK Check-ins (acks NEW rows using short codes), Spotter-Group (send E? F!### to group), Spotter-Callsign (send to selected row), Select Frequency + QSY (right side), Ad Hoc Net (right of QSY), Save Checkins, End Net (red).</li>
    <li><strong>Check-ins table columns</strong>: CALLSIGN, NAME, ST, GRID, REGION, MODE, SNR, DT ms, OFFSET, STATUS.</li>
    <li><strong>Status logic</strong>: NEW on first sighting after Start. ACK Check-ins sends "ACK {short codes}" and sets rows to ACKED (green). Receiving the requested F!### updates STATUS to that form value; if a different F!### arrives, the cell is red but stored. Latest SNR/DT/Offset/Mode always overwrite.</li>
    <li><strong>Input rules</strong>: Only traffic containing F!103 or F!104 counts as a check-in. Polling uses JS8 API and DIRECTED/ALL logs; short code parsing trims suffixes and ensures uniqueness.</li>
    <li><strong>Net lifecycle</strong>: Start clears table and pauses auto-query features. End saves check-ins (once per callsign per net) and resumes auto-query if enabled.</li>
    <li><strong>Auto-query (timing)</strong>: Runs only when no net is active. After receiving YES MSG ID replies, waits ~45 seconds to collect them all, then queries each callsign/msg in order. Each QUERY waits for activity for ~30 seconds; missing completion (diamond) or no reply marks it failed and moves on.</li>
    <li><strong>Announcements (F!106)</strong>: When no net is in progress, a fully received F!106 net announcement from DIRECTED.TXT triggers a popup alert. Decoding uses the configured JS8Spotter forms folder.</li>
    <li><strong>QSY</strong>: Same shared pause timer; disabled if scheduler off or frequency unchanged.</li>
  </ul>

  <h2 id="other-tabs">5. Other Tabs</h2>

  <h3 id="messages">Messages Tab</h3>
  <ul class="section-list">
    <li>Shows JS8Call, VarAC, FLMSG, and FLAMP messages from configured paths. Filtering and search follow the tab controls. No rig control occurs here.</li>
  </ul>

  <h3 id="operators">Operators Tab</h3>
  <ul class="section-list">
    <li>Operator history table: callsign, name, state, grid, region, groups, check-in count, trust flag. Updated by net imports and manual edits elsewhere.</li>
  </ul>

  <h3 id="peer-schedules">Peer Schedules Tab</h3>
  <ul class="section-list">
    <li>Displays imported schedules from other operators. Columns include callsign, name, state, grid, groups, and schedule rows.</li>
    <li>Filters by callsign, region, and groups. Buttons allow import/export (when available), delete selected operator schedules, and clear all.</li>
  </ul>

  <h3 id="map">Map Tab</h3>
  <ul class="section-list">
    <li><strong>Layers</strong>: Shows operator history (stored grids), recent JS8 traffic-derived grids, and net-related stations when applicable. Use to visualize coverage and peers.</li>
    <li><strong>Form decoding</strong>: Spotter form details use the JS8Spotter forms folder configured in Settings to decode F!### payloads.</li>
  </ul>

  <h3 id="logs">Logs Tab</h3>
  <ul class="section-list">
    <li><strong>Level</strong>: Disabled (no file writes), Error, Warning, Info, Debug, All.</li>
    <li>Affects both UI filtering and on-disk logging. Hot-loop scheduler and JS8 poll logs are Debug; choose All to see everything.</li>
    <li>Use Disabled/Info for daily use to keep files small; raise to Debug/All when troubleshooting.</li>
  </ul>

  <h3 id="help">Help Tab</h3>
  <ul class="section-list">
    <li>Shows this guide. Left pane is a Table of Contents built from H1-H3 headings; click to jump. A "Table of Contents" header appears above the list.</li>
  </ul>

  <h2 id="troubleshooting">6. Troubleshooting and Tips</h2>
  <ul class="section-list">
    <li><strong>Scheduler not changing frequency</strong>: Verify Use Scheduler is on, pause timer expired, and Operating Group has mode/band/frequency.</li>
    <li><strong>JS8 auto-query stalls</strong>: Confirm JS8Call API reachable; set Logs tab to Debug/All to see queue and timeout decisions.</li>
    <li><strong>File paths</strong>: Use Browse buttons for DIRECTED.TXT and message folders to avoid typos.</li>
    <li><strong>Logging size</strong>: Keep level at Disabled or Info normally; raise only when collecting diagnostics.</li>
  </ul>

  <h2 id="licensing">7. Licensing</h2>
  <ul class="section-list">
    <li><strong>FreqInOut</strong>: Distributed under the MIT License (see <code>LICENSE.md</code> in the repository).</li>
    <li><strong>Third-party components</strong>: This project bundles or interfaces with third-party software (for example PySide6/Qt, JS8Call logs, FLRig). Each remains under its own license; review their terms when redistributing.</li>
  </ul>
</body>
</html>
